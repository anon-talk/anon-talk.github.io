<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ANONTALK - Authentication</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- FirebaseUI CSS -->
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />

  <style>
    :root {
      --background-primary: #0A0A0A;
      --background-secondary: #1A1A1A;
      --text-primary: #E8E8E8;
      --text-secondary: #888888;
      --accent-primary: #00D4FF;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background-color: var(--background-primary);
      color: var(--text-primary);
      font-family: 'Space Grotesk', 'JetBrains Mono', monospace;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .auth-container {
      width: 100%;
      max-width: 400px;
      padding: 2rem;
      border: 1px solid var(--background-secondary);
      border-radius: 8px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    }

    .auth-header { text-align: center; margin-bottom: 2rem; font-family: 'JetBrains Mono', monospace; }

    .auth-title { font-size: 24px; font-weight: 700; color: var(--text-primary); margin-bottom: 0.5rem; }
    .auth-subtitle { font-size: 14px; color: var(--text-secondary); }

    /* FirebaseUI button tweaks */
    .firebaseui-idp-button { background-color: var(--background-secondary) !important; border-radius: 999px !important; }
    .firebaseui-idp-text { color: var(--text-primary) !important; }
  </style>
</head>
<body>
  <div class="auth-container">
    <div class="auth-header">
      <h1 class="auth-title">ANONTALK Network</h1>
      <p class="auth-subtitle">Authentication Required</p>
    </div>

    <!-- FirebaseUI mount point -->
    <div id="firebaseui-auth-container"></div>
  </div>

  <!-- FirebaseUI (CDN script) - leaves window.firebaseui available -->
  <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>

  <!-- Use ES modules for the modular Firebase SDK and our central init -->
  <script type="module">
    // Import the modular auth instance created in firebase-init.js
    import { auth } from './firebase-init.js';

    // Import provider classes (modular SDK) to get PROVIDER_ID constants
    import { GoogleAuthProvider, EmailAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    // Make sure firebaseui (global) is available
    if (!window.firebaseui || !window.firebaseui.auth) {
      console.error("FirebaseUI library did not load. Check network or script order.");
      // You can optionally show a friendly UI fallback here.
      throw new Error("FirebaseUI not available");
    }

    // Initialize the FirebaseUI Widget using the modular auth instance.
    // firebaseui exposes a global 'firebaseui' object; its AuthUI accepts a modular Auth instance.
    const ui = new window.firebaseui.auth.AuthUI(auth);

    // Configure and start the widget.
    ui.start('#firebaseui-auth-container', {
      signInSuccessUrl: 'index.html',
      signInOptions: [
        // Use modular provider IDs (no global `firebase` required)
        GoogleAuthProvider.PROVIDER_ID,
        EmailAuthProvider.PROVIDER_ID
      ],
      // Optional: customize behavior, callbacks, etc.
      // callbacks: {
      //   signInSuccessWithAuthResult(authResult, redirectUrl) { return true; }
      // }
    });
  </script>
</body>
</html>
